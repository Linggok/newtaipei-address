# 新北市地址查詢系統 - 可攜式版本

## 概述

這個系統可以打包成可攜式版本，讓您可以在任何 Windows 電腦上使用，**不需要安裝 Node.js**。

## 建立可攜式版本的方法

### 方法一：使用 pkg 打包（推薦）

1. **執行建立腳本**：
   ```bash
   建立可攜式版本.bat
   ```

2. **等待打包完成**（可能需要幾分鐘）

3. **完成後**，在 `dist` 資料夾中會產生：
   - `newtaipei-address-lookup.exe` - 主程式（單一執行檔）
   - `啟動服務.bat` - 啟動腳本
   - 所有 CSV 資料檔案
   - `public` 資料夾（網頁介面）
   - `README.txt` - 使用說明

4. **使用方式**：
   - 將整個 `dist` 資料夾複製到 USB 隨身碟或任何位置
   - 在任何 Windows 電腦上，雙擊 `啟動服務.bat`
   - 在瀏覽器開啟 `http://localhost:3000`

### 方法二：使用 Node.js Portable（較靈活）

如果您想要更靈活的方案，可以：

1. **下載 Node.js Portable**：
   - 從 [PortableApps.com](https://portableapps.com/apps/development/nodejs_portable) 下載
   - 或使用 [nvm-windows](https://github.com/coreybutler/nvm-windows) 的 portable 版本

2. **建立可攜式資料夾結構**：
   ```
   新北市地址查詢系統/
   ├── nodejs/          (Node.js Portable)
   ├── app/             (您的應用程式)
   │   ├── server.js
   │   ├── package.json
   │   ├── *.csv
   │   └── public/
   └── 啟動服務.bat
   ```

3. **建立啟動腳本**（參考下方的腳本範例）

## 可攜式版本特點

✅ **不需要安裝 Node.js** - 使用 pkg 打包後，所有依賴都包含在執行檔中  
✅ **資料完整** - 所有 CSV 門牌資料都包含在內  
✅ **即插即用** - 複製到 USB 隨身碟即可使用  
✅ **跨電腦使用** - 可在任何 Windows 電腦上執行  

## 系統需求

- Windows 7 或更新版本（64 位元）
- 不需要安裝任何額外軟體

## 注意事項

⚠️ **Windows Defender 警告**：首次執行時，Windows 可能會顯示安全性警告，這是正常的（因為是未簽章的執行檔），請選擇「仍要執行」或「更多資訊」→「仍要執行」

⚠️ **防火牆**：系統會在本地 3000 埠啟動服務，Windows 防火牆可能會詢問，請允許存取

⚠️ **資料更新**：如果需要更新門牌資料，請在原始專案中更新 CSV 檔案後重新打包

## 手動建立啟動腳本（方法二使用）

如果您使用方法二（Node.js Portable），可以使用以下啟動腳本：

```batch
@echo off
chcp 65001 >nul
cd /d "%~dp0"

REM 設定 Node.js Portable 路徑
set NODE_PATH=%~dp0nodejs\node.exe

if not exist "%NODE_PATH%" (
    echo 錯誤：找不到 Node.js Portable
    echo 請確認 nodejs 資料夾存在且包含 node.exe
    pause
    exit /b 1
)

cd app

if not exist "node_modules" (
    echo 正在安裝依賴...
    "%NODE_PATH%" npm install
)

echo 正在啟動新北市地址查詢服務...
echo 啟動後請在瀏覽器開啟: http://localhost:3000
echo 關閉此視窗即可停止服務.
echo.

"%NODE_PATH%" server.js

pause
```

## 進階選項

### 打包多平台版本

修改 `package-portable.json` 中的 `build:portable-all` 腳本，可以打包多個平台：

```json
"build:portable-all": "pkg . --targets node18-win-x64,node18-win-x86,node18-linux-x64,node18-macos-x64 --output dist/newtaipei-address-lookup"
```

### 自訂埠號

在 `dist` 資料夾中建立 `.env` 檔案：

```env
PORT=8080
```

然後修改啟動腳本，在執行前設定環境變數。

## 疑難排解

**Q: 執行檔無法啟動？**  
A: 確認 Windows 版本是否為 64 位元，或重新打包為 32 位元版本

**Q: 找不到 CSV 檔案？**  
A: 確認所有 CSV 檔案都已複製到 dist 資料夾

**Q: 網頁無法開啟？**  
A: 確認防火牆允許存取，或檢查是否有其他程式佔用 3000 埠

# 手動打包說明

如果自動打包腳本失敗，可以按照以下步驟手動打包：

## 步驟 1：安裝依賴

```bash
npm install
```

這會安裝所有依賴，包括 `pkg`。

## 步驟 2：確認 pkg 已安裝

```bash
npm list pkg
```

如果顯示 `(empty)`，執行：

```bash
npm install pkg --save-dev
```

## 步驟 3：建立 dist 資料夾並複製檔案

```bash
mkdir dist
copy *.csv dist\
xcopy /E /I public dist\public
```

## 步驟 4：執行打包

```bash
npx pkg . --targets node18-win-x64 --output dist\newtaipei-address-lookup.exe
```

或使用本地安裝的 pkg：

```bash
node_modules\.bin\pkg.cmd . --targets node18-win-x64 --output dist\newtaipei-address-lookup.exe
```

## 常見錯誤與解決方案

### 錯誤：Cannot find module 'pkg'

**解決方案**：
```bash
npm install pkg --save-dev
```

### 錯誤：Node.js version mismatch

**解決方案**：
- 確認 Node.js 版本為 18 或以上：`node --version`
- 如果版本不符，請升級 Node.js

### 錯誤：ENOENT: no such file or directory

**解決方案**：
- 確認在專案根目錄執行命令
- 確認 `server.js` 和 `package.json` 存在

### 錯誤：下載 Node.js 二進位檔失敗

**解決方案**：
- 檢查網路連線
- pkg 需要下載對應平台的 Node.js 二進位檔（約 50-100 MB）
- 如果網路不穩定，可能需要多次嘗試

### 錯誤：磁碟空間不足

**解決方案**：
- 清理磁碟空間
- dist 資料夾需要至少 200 MB 空間

## 替代方案：使用 Electron

如果 pkg 打包持續失敗，可以考慮使用 Electron 打包成桌面應用：

1. 安裝 Electron：
```bash
npm install electron --save-dev
```

2. 建立 `electron-main.js`（主程式）

3. 使用 electron-builder 或 electron-packager 打包

## 替代方案：使用 Docker

如果目標環境支援 Docker，可以建立 Docker 映像：

1. 建立 `Dockerfile`
2. 建立 `docker-compose.yml`
3. 執行 `docker-compose up`

## 最簡單的方案：直接使用 Node.js

如果打包持續失敗，最簡單的方案是：

1. 將整個專案資料夾複製到 USB
2. 在目標電腦安裝 Node.js
3. 執行 `npm install` 安裝依賴
4. 執行 `npm start` 啟動服務

這樣雖然需要安裝 Node.js，但最穩定可靠。
